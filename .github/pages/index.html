<!DOCTYPE html>
<meta charset="utf-8" />
<meta name="title" content="ps12exe Online" />
<meta name="description" content="A super cool online compiler for powershell scripts" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/729678966/3ed3f02f-c7c9-4a18-b1f5-255e667643b6" />
<meta property="og:image:alt" content="A super cool online compiler for powershell scripts" />
<meta property="og:type" content="object" />
<meta property="og:title" content="ps12exe Online" />
<meta property="og:description" content="A super cool online compiler for powershell scripts" />
<html>

<head>
	<title>ps12exe Online</title>
	<link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/steve02081504/ps12exe/master/img/icon.ico" />
	<script src='https://www.midijs.net/lib/midi.js'></script>
	<script src="https://cdn.jsdelivr.net/npm/darkreader"></script>
	<script>
		DarkReader.setFetchMethod(window.fetch)
		DarkReader.enable()
		let HighlightCode
		function SetDarkMode(Set) {
			if (Set) DarkReader.enable()
			else DarkReader.disable()
			HighlightCode.useTheme(Set ? 'github-dark' : 'github')
		}
		(async ({ chrome, netscape }) => {
			if (!chrome && !netscape) await import('https://cdn.jsdelivr.net/npm/@ungap/custom-elements')
			HighlightCode = await import('https://cdn.jsdelivr.net/npm/highlighted-code/min.js').then(x => x.default)
			const dark = window.matchMedia('(prefers-color-scheme: dark)')
			SetDarkMode(dark.matches)
			dark.addEventListener('change', event => {
				SetDarkMode(event.matches)
			})
		})(self)
	</script>
</head>

<body>
	<textarea style="width: 98%; height:95vh;" is="highlighted-code" language="powershell" tabSize="4" placeholder="#_pragma noConsole
'Hello ‰∏ñÁïåÔºÅüëæ'
" id="inputText">#_pragma noConsole
'Hello ‰∏ñÁïåÔºÅüëæ'
</textarea>
	<br />
	<button id="compileButton" onclick="compileCode()">cum out</button>
	<script type="text/javascript">
		const translations = {
			'zh-CN': { compileButtonText: 'ÁºñËØë', compileMessage: 'Â∑≤Â∞ÜÁºñËØëÁî®ÁöÑPowershell‰ª£Á†ÅÂ§çÂà∂Âà∞Ââ™ÂàáÊùøÔºÅ\nÁé∞Âú®‰Ω†Âè™ÈúÄË¶ÅÂú®PowershellÈáåÁ≤òË¥¥Âπ∂ËøêË°å‰ª£Á†ÅÂ∞±ÂèØ‰ª•ÂæóÂà∞ÁºñËØëÁªìÊûú‰∫ÜÔºÅ' },
			'zh-TW': { compileButtonText: 'Á∑®Ë≠Ø', compileMessage: 'Â∑≤Â∞áÁ∑®Ë≠ØÁî®ÁöÑPowershell‰ª£Á¢ºË§áË£ΩÂà∞Ââ™Ë≤ºÁ∞øÔºÅ\nÁèæÂú®‰Ω†Âè™ÈúÄË¶ÅÂú®PowershellË£°Á≤òË≤º‰∏¶Âü∑Ë°å‰ª£Á¢ºÂ∞±ÂèØ‰ª•ÂæóÂà∞Á∑®Ë≠ØÁµêÊûú‰∫ÜÔºÅ' },
			'zh-HK': { compileButtonText: 'Á∑®Ë≠Ø', compileMessage: 'Â∑≤Â∞áÁ∑®Ë≠ØÁî®ÁöÑPowershell‰ª£Á¢ºË§áË£ΩÂà∞Ââ™Ë≤ºÁ∞øÔºÅ\nÁèæÂú®‰Ω†Âè™ÈúÄË¶ÅÂú®PowershellË£°Á≤òË≤º‰∏¶Âü∑Ë°å‰ª£Á¢ºÂ∞±ÂèØ‰ª•ÂæóÂà∞Á∑®Ë≠ØÁµêÊûú‰∫ÜÔºÅ' },
			'es-ES': { compileButtonText: 'compilar', compileMessage: 'Se ha copiado el c√≥digo de Powershell para compilar en el portapapeles. Ahora solo necesitas pegarlo y ejecutarlo en Powershell para obtener el resultado de la compilaci√≥n.' },
			'ja-JP': { compileButtonText: '„Ç≥„É≥„Éë„Ç§„É´', compileMessage: 'Powershell„ÅÆ„Ç≥„É≥„Éë„Ç§„É´Áî®„Ç≥„Éº„Éâ„Åå„ÇØ„É™„ÉÉ„Éó„Éú„Éº„Éâ„Å´„Ç≥„Éî„Éº„Åï„Çå„Åæ„Åó„ÅüÔºÅ\n„Åì„Çå„ÇíPowershell„Å´Ë≤º„Çä‰ªò„Åë„Å¶ÂÆüË°å„Åô„Çã„Å†„Åë„Åß„ÄÅ„Ç≥„É≥„Éë„Ç§„É´ÁµêÊûú„ÅåÂæó„Çâ„Çå„Åæ„ÅôÔºÅ' },
			'ko-KR': { compileButtonText: 'Ïª¥ÌååÏùº', compileMessage: 'Powershell ÏΩîÎìúÎ•º Ïª¥ÌååÏùºÌïòÍ∏∞ ÏúÑÌïú ÎÇ¥Ïö©Ïù¥ ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§! Ïù¥Ï†ú PowershellÏóêÏÑú Ìï¥Îãπ ÏΩîÎìúÎ•º Î∂ôÏó¨ÎÑ£Í≥† Ïã§ÌñâÌïòÎ©¥ Ïª¥ÌååÏùº Í≤∞Í≥ºÎ•º ÏñªÏùÑ Ïàò ÏûàÏäµÎãàÎã§!' },
			'ru-RU': { compileButtonText: '–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å', compileMessage: '–ö–æ–¥ –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –Ω–∞ Powershell –±—ã–ª —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! –¢–µ–ø–µ—Ä—å –≤–∞–º –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –≤—Å—Ç–∞–≤–∏—Ç—å –µ–≥–æ –≤ Powershell –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏!' },
			'en-UK': { compileButtonText: 'compile', compileMessage: 'The Powershell code for compilation has been copied to the clipboard! Now you just need to paste and run the code in Powershell to get the compilation result!' },
			'pt-PT': { compileButtonText: 'compilar', compileMessage: 'O c√≥digo Powershell para compila√ß√£o foi copiado para a √°rea de transfer√™ncia! Agora voc√™ s√≥ precisa colar e executar o c√≥digo no Powershell para obter o resultado da compila√ß√£o!' }
		}
		for (const key of Object.keys(translations)) translations[key.split('-')[0]] ??= translations[key]

		let language = navigator.language || navigator.userLanguage || 'en'
		if (!translations[language]) language = language.split('-')[0]
		if (!translations[language]) language = 'en'
		const { compileButtonText, compileMessage } = translations[language]

		const compileButton = document.getElementById('compileButton')
		const inputText = document.getElementById('inputText')
		let playing = false
		inputText.addEventListener('focus', event => {
			if (playing) MIDIjs.resume()
			else MIDIjs.play('https://raw.githubusercontent.com/steve02081504/ps12exe/master/src/bin/Unravel.mid', true)
			playing = true
		})
		inputText.addEventListener('blur', event => MIDIjs.pause())

		compileButton.textContent = compileButtonText
		function compileCode() {
			const code = inputText.value
			const compileCodebase = code.replace(/'/g, '\'\'')
			const compileCode = 'if (-not (Get-Module -ListAvailable ps12exe)) { Install-Module ps12exe -Force -Scope CurrentUser };' +
				'\'' + compileCodebase + '\' | ps12exe'
			navigator.clipboard.writeText(compileCode)
			alert(compileMessage)
		}
	</script>
</body>

</html>
